<md-card>
  <md-card-title>Data File upload</md-card-title>
  <md-card-subtitle>Upload excel files in the correct format</md-card-subtitle>

  <md-card-content>
    <small *ngIf="success" style="color: green;">{{success}}</small>
    <small *ngIf="fail" style="color: red;">{{fail}}</small>
    <small *ngIf="importAbort" style="color: red;">{{importAbort}}</small>
    <div  fxLayout="row"  fxLayoutWrap="wrap"  fxLayoutAlign="start">
      <div fxFlex.gt-sm="40" fxFlex.gt-xs="40" fxFlex="100"  class="pr-1">
        <h6 class="mt-0">Select a file</h6>
        <form [formGroup]="form"  method="post"  enctype="multipart/form-data">

          <!--original<input id="fileSelect"  [formControl]="form.controls['myfile']" type="file" (change)="Importupload($event)"  name="file" accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" />
          -->
          <input id="fileSelect"  [formControl]="form.controls['myfile']" type="file" #myfile name="file" accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" />
          <br><br>
          You need to <b>Verify</b> the data before importing.
          <button md-raised-button md-button-sm class="shadow-none"  type="button" (click)="Verifyupload()">Verify</button>
          <br>
          <div class="mb-1" style="margin-top: 10px;">
            <button md-raised-button md-button-sm color="primary" (click)="Importupload()" type="button">Upload</button>
            <button md-raised-button md-button-sm color="warn" (click)="AbortImport()" type="button">Cancel</button>
            <button md-raised-button md-button-sm color="accent" type="button">Remove</button>
          </div>
        </form>
      </div>
      <!--
      <div fxFlex.gt-sm="40" fxFlex.gt-xs="40" fxFlex="100" class="mb-1">
        <p>Queue progress:</p>
        <md-progress-bar mode="determinate" value=""></md-progress-bar>
      </div>-->
      <!--
      <div fxFlex.gt-sm="80" fxFlex.gt-xs="50" fxFlex="100">
        <ngx-datatable
          class="material ml-0 mr-0"
          [rows]=""
          [columnMode]="'flex'"
          [headerHeight]="50"
          [footerHeight]="0"
          [rowHeight]="'auto'">
          <ngx-datatable-column name="Name" [flexGrow]="2">
            <template let-row="row" ngx-datatable-cell-template>
              {{ row?.file?.name }}
            </template>
          </ngx-datatable-column>
          <ngx-datatable-column name="Size"  [flexGrow]="1">
            <template let-row="row" ngx-datatable-cell-template>
              {{ row?.file?.size/1024/1024 | number:'.2' }} MB
            </template>
          </ngx-datatable-column>
          <ngx-datatable-column name="Progress"  [flexGrow]="1">
            <template let-row="row" ngx-datatable-cell-template>
              <md-progress-bar mode="determinate" value="{{row.progress}}"></md-progress-bar>
            </template>
          </ngx-datatable-column>
          <ngx-datatable-column name="status" [flexGrow]="1">
            <template let-row="row" ngx-datatable-cell-template>
              <span *ngIf="row.isSuccess"><md-icon>check</md-icon></span>
              <span *ngIf="row.isCancel"><md-icon>cancel</md-icon></span>
              <span *ngIf="row.isError"><md-icon>delete</md-icon></span>
            </template>
          </ngx-datatable-column>
          <ngx-datatable-column name="action" [flexGrow]="2">
            <template let-row="row" ngx-datatable-cell-template>

              <button md-raised-button md-button-sm color="primary" type="button"
                (click)="row.upload()" [disabled]="row.isReady || row.isUploading || row.isSuccess">Upload</button>
              <button md-raised-button md-button-sm color="warn" type="button"
                (click)="row.cancel()" [disabled]="!row.isUploading">Cancel</button>
              <button md-raised-button md-button-sm color="accent" type="button"
                (click)="row.remove()">Remove
              </buttfon>
            </template>
          </ngx-datatable-column>
        </ngx-datatable>


      </div>-->

    </div>
  </md-card-content>
</md-card>

<!--errors display-->
<div fxLayout="row"  fxLayoutWrap="wrap">
  <div fxFlex.gt-sm="33" fxFlex.gt-xs="50" fxFlex="100">
    <md-card class="card-widget md-white">
      <div md-card-widget>
        <div class="pl-0">
          <h6 md-card-widget-title><b>{{ total_success }}</b></h6>
          <small>Total Success</small>
        </div>
      </div>
    </md-card>
  </div>
  <div fxFlex.gt-sm="34" fxFlex.gt-xs="50" fxFlex="100">
    <md-card class="card-widget md-white">
      <div md-card-widget>
        <div class="pl-0">
          <h6 md-card-widget-title>{{ total_fails }}</h6>
          <small>Total Fails</small>
        </div>
      </div>
    </md-card>
  </div>
  <div fxFlex.gt-sm="33" fxFlex.gt-xs="50" fxFlex="100">
    <md-card class="card-widget md-white">
      <div md-card-widget>
        <div class="pl-0">
          <h6 md-card-widget-title>{{ success_percentage }}</h6>
          <small>Success percentage</small>
        </div>
      </div>
    </md-card>
  </div>
</div>

<ngx-datatable
  class="material fullscreen"
  [columns]="columns"
  [sortType]="'multi'"
  [columnMode]="'force'"
  [headerHeight]="50"
  [footerHeight]="50"
  [rowHeight]="auto"
  [rows]="errors"
  [count]="count"
  [offset]="offset"
  [limit]="limit">
</ngx-datatable>
